<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>Express Example</h1><p>This repository demonstrates the usage of Sequelize within an <a href="https://expressjs.com">Express</a> application.
The implemented logic is a simple task tracking tool.</p>
<p><a href="https://heroku.com/deploy"><img src="https://www.herokucdn.com/deploy/button.svg" alt="Deploy"></a></p>
<h2>Starting App</h2><p><strong>Without Migrations</strong></p>
<pre class="prettyprint source"><code>npm install
npm start</code></pre><p><strong>With Migrations</strong></p>
<pre class="prettyprint source"><code>npm install
node_modules/.bin/sequelize db:migrate
npm start</code></pre><p>This will start the application and create an sqlite database in your app dir.
Just open <a href="http://localhost:3000">http://localhost:3000</a>.</p>
<h2>Running Tests</h2><p>We have added some <a href="https://mochajs.org">Mocha</a> based test. You can run them by <code>npm test</code></p>
<h2>Setup in Details</h2><p>In order to understand how this application has been built, you can find the
executed steps in the following snippet. You should be able to adjust those
steps according to your needs. Please note that the view and the routes aren't
described. You can find those files in the repo.</p>
<h4>Express Setup</h4><p>First we will create a bare Express App using <code>express-generator</code> <a href="https://expressjs.com/en/starter/generator.html">Express Generator</a></p>
<pre class="prettyprint source lang-bash"><code># install express generator globally
npm install -g express-generator

# create the sample app
mkdir express-example
cd express-example
express -f

# install all node modules
npm install</code></pre><h4>Sequelize Setup</h4><p>Now we will install all sequelize related modules.</p>
<pre class="prettyprint source lang-bash"><code># install ORM , CLI and SQLite dialect
npm install --save sequelize sequelize-cli sqlite3

# generate models
node_modules/.bin/sequelize init
node_modules/.bin/sequelize model:create --name User --attributes username:string
node_modules/.bin/sequelize model:create --name Task --attributes title:string</code></pre><p>We are using <code>.sequelizerc</code> setup change config path for migrations. You can read more about this in <a href="http://docs.sequelizejs.com/manual/tutorial/migrations.html#the-sequelizerc-file">migration docs</a></p>
<pre class="prettyprint source lang-js"><code>// .sequelizerc
const path = require('path');

module.exports = {
  'config': path.resolve('config', 'config.js')
}</code></pre><p>You will now have a basic express application with some additional directories
(config, models, migrations). Also you will find two migrations and models.
One for the <code>User</code> and one for the <code>Task</code>.</p>
<p>In order to associate the models with each other, you need to change the models
like this:</p>
<pre class="prettyprint source lang-js"><code>// task.js
// ...
  Task.associate = function(models) {
    // Using additional options like CASCADE etc for demonstration
    // Can also simply do Task.belongsTo(models.User);
    Task.belongsTo(models.User, {
      onDelete: &quot;CASCADE&quot;,
      foreignKey: {
        allowNull: false
      }
    });
  }
// ...</code></pre><pre class="prettyprint source lang-js"><code>// user.js
// ...
  User.associate = function(models) {
    User.hasMany(models.Task);
  }
// ...</code></pre><p>This association will create an attribute <code>UserId</code> in <code>Task</code> model. We have to amend our <code>create-task</code> migration and add this column.</p>
<pre class="prettyprint source lang-js"><code>// xxxxxxx-create-task.js
// ...
  UserId: {
    type: Sequelize.INTEGER,
    onDelete: &quot;CASCADE&quot;,
    allowNull: false,
    references: {
      model: 'Users',
      key: 'id'
    }
  }
// ...</code></pre><p>If you want to use the automatic table creation that sequelize provides,
you have to adjust the <code>bin/www</code> file to this:</p>
<pre class="prettyprint source lang-js"><code>#!/usr/bin/env node

var app = require('../app');
var debug = require('debug')('init:server');
var http = require('http');
var models = require(&quot;../models&quot;);

var port = normalizePort(process.env.PORT || '3000');
app.set('port', port);

var server = http.createServer(app);

// sync() will create all table if they doesn't exist in database
models.sequelize.sync().then(function () {
  server.listen(port);
  server.on('error', onError);
  server.on('listening', onListening);
});

function normalizePort(val) { /* ... */ }
function onError(error) { /* ... */ }
function onListening() { /* ... */ }</code></pre><p>And finally you have to adjust the <code>config/config.js</code> to fit your environment.
Once thats done, your database configuration is ready!</p></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-lib_helpers_errorHandling.html">lib/helpers/errorHandling</a></li></ul><h3>Global</h3><ul><li><a href="global.html#checkPassword">checkPassword</a></li><li><a href="global.html#encrypt">encrypt</a></li><li><a href="global.html#generateJWT">generateJWT</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Sep 11 2018 18:41:49 GMT-0300 (-03)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>